import{_ as C,p as B,c as f,b as E,t as D,a as t,w as o,h as U,s as N,r as s,l as Y,i as j,u as M,o as m,F as v,j as w,e as T,g as k,E as V}from"./index-CBuLFx-0.js";import{b as P,u as R,c as $}from"./item-DYlBHeIQ.js";import{g as L,a as O}from"./meta-Dreweh91.js";import"./http-BrSQrTbV.js";const S={class:"card-panel panel"},q={__name:"ItemFormView",setup(z){const r=Y(),x=M(),b=U([]),_=U([]),e=j({mediaType:1,contentType:1,content:"",title:"",fandom:"",cp:"",author:"",sourceUrl:"",releaseYear:null,trackingType:null,rating:null,notes:"",summary:"",fanficForm:null,tags:[],plts:[]}),p=N(()=>!!r.params.id),F=async()=>{if(!p.value)return;const i=await P(r.params.id);Object.assign(e,i)},I=async()=>{if(!e.mediaType||!e.contentType||!e.fandom||!e.cp)return V.warning("请先填写必填项");p.value?(await R(r.params.id,e),V.success("更新成功")):(await $(e),V.success("创建成功")),x.push("/items")};return B(async()=>{b.value=await L(),_.value=await O(),F()}),(i,a)=>{const d=s("el-input-number"),n=s("el-form-item"),u=s("el-input"),y=s("el-option"),c=s("el-select"),g=s("el-button"),A=s("el-form");return m(),f("section",S,[E("h2",null,D(p.value?"编辑作品":"新增作品"),1),t(A,{model:e,"label-position":"top",class:"form-grid"},{default:o(()=>[t(n,{label:"媒体类型（必填）"},{default:o(()=>[t(d,{modelValue:e.mediaType,"onUpdate:modelValue":a[0]||(a[0]=l=>e.mediaType=l),min:1},null,8,["modelValue"])]),_:1}),t(n,{label:"内容类型（必填）"},{default:o(()=>[t(d,{modelValue:e.contentType,"onUpdate:modelValue":a[1]||(a[1]=l=>e.contentType=l),min:1},null,8,["modelValue"])]),_:1}),t(n,{label:"Fandom（必填）"},{default:o(()=>[t(u,{modelValue:e.fandom,"onUpdate:modelValue":a[2]||(a[2]=l=>e.fandom=l)},null,8,["modelValue"])]),_:1}),t(n,{label:"CP（必填）"},{default:o(()=>[t(u,{modelValue:e.cp,"onUpdate:modelValue":a[3]||(a[3]=l=>e.cp=l)},null,8,["modelValue"])]),_:1}),t(n,{label:"标题"},{default:o(()=>[t(u,{modelValue:e.title,"onUpdate:modelValue":a[4]||(a[4]=l=>e.title=l)},null,8,["modelValue"])]),_:1}),t(n,{label:"作者"},{default:o(()=>[t(u,{modelValue:e.author,"onUpdate:modelValue":a[5]||(a[5]=l=>e.author=l)},null,8,["modelValue"])]),_:1}),t(n,{label:"来源链接",class:"span-2"},{default:o(()=>[t(u,{modelValue:e.sourceUrl,"onUpdate:modelValue":a[6]||(a[6]=l=>e.sourceUrl=l)},null,8,["modelValue"])]),_:1}),t(n,{label:"年份"},{default:o(()=>[t(d,{modelValue:e.releaseYear,"onUpdate:modelValue":a[7]||(a[7]=l=>e.releaseYear=l),min:1900,max:3e3},null,8,["modelValue"])]),_:1}),t(n,{label:"评分(0-10)"},{default:o(()=>[t(d,{modelValue:e.rating,"onUpdate:modelValue":a[8]||(a[8]=l=>e.rating=l),step:.5,min:0,max:10},null,8,["modelValue"])]),_:1}),t(n,{label:"标签"},{default:o(()=>[t(c,{modelValue:e.tags,"onUpdate:modelValue":a[9]||(a[9]=l=>e.tags=l),multiple:"",filterable:"","allow-create":"","default-first-option":""},{default:o(()=>[(m(!0),f(v,null,w(b.value,l=>(m(),T(y,{key:l.id,label:l.name,value:l.name},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(n,{label:"平台"},{default:o(()=>[t(c,{modelValue:e.plts,"onUpdate:modelValue":a[10]||(a[10]=l=>e.plts=l),multiple:"",filterable:"","allow-create":"","default-first-option":""},{default:o(()=>[(m(!0),f(v,null,w(_.value,l=>(m(),T(y,{key:l.id,label:l.name,value:l.name},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(n,{label:"简介",class:"span-2"},{default:o(()=>[t(u,{modelValue:e.summary,"onUpdate:modelValue":a[11]||(a[11]=l=>e.summary=l),type:"textarea",rows:"3"},null,8,["modelValue"])]),_:1}),t(n,{label:"备注",class:"span-2"},{default:o(()=>[t(u,{modelValue:e.notes,"onUpdate:modelValue":a[12]||(a[12]=l=>e.notes=l),type:"textarea",rows:"3"},null,8,["modelValue"])]),_:1}),t(n,{class:"span-2"},{default:o(()=>[t(g,{type:"primary",onClick:I},{default:o(()=>[...a[14]||(a[14]=[k("保存",-1)])]),_:1}),t(g,{onClick:a[13]||(a[13]=l=>i.$router.back())},{default:o(()=>[...a[15]||(a[15]=[k("取消",-1)])]),_:1})]),_:1})]),_:1},8,["model"])])}}},Q=C(q,[["__scopeId","data-v-42e47c59"]]);export{Q as default};

import{_ as I,q as N,c as x,b as _,t as z,a as n,w as s,s as L,r as l,h as f,i as V,j as B,u as E,o as M,g as u,v as P,E as R}from"./index-DpViZ-ad.js";import{d as D,a as j}from"./item-B8raeaaP.js";import"./http-DCShZfjV.js";const A={class:"card-panel panel"},F={class:"head"},S={__name:"ItemListView",setup(Q){const i=B(),T=E(),d=f([]),m=f(0),t=V({page:1,size:10,contentType:void 0,mediaType:void 0}),b={1:"文章",2:"图绘",3:"精修",4:"混剪",5:"解析",6:"吐槽",7:"主创说",8:"RPS",9:"其他"},v={1:"文本",2:"图片",3:"视频",4:"链接"},w=L(()=>{const a=["全部资源"];return t.contentType&&a.push(b[t.contentType]||`内容类型 ${t.contentType}`),t.mediaType&&a.push(v[t.mediaType]||`格式 ${t.mediaType}`),a.join(" / ")}),c=a=>{const e=Number.parseInt(a,10);return Number.isNaN(e)||e<=0?void 0:e},h=()=>{t.page=c(i.query.page)||1,t.contentType=c(i.query.contentType),t.mediaType=c(i.query.mediaType)},y=async()=>{const a={page:t.page,size:t.size};t.contentType&&(a.contentType=t.contentType),t.mediaType&&(a.mediaType=t.mediaType);const e=await j(a);d.value=(e==null?void 0:e.records)||[],m.value=Number((e==null?void 0:e.total)||0)},C=async a=>{await T.push({path:"/items",query:{...i.query,page:a}})},$=async a=>{await P.confirm("确认删除该作品吗？","提示",{type:"warning"}),await D(a),R.success("删除成功"),y()};return N(()=>i.query,()=>{h(),y()},{immediate:!0}),(a,e)=>{const p=l("el-button"),o=l("el-table-column"),k=l("el-table"),q=l("el-pagination");return M(),x("section",A,[_("div",F,[_("h2",null,z(w.value),1),n(p,{type:"primary",onClick:e[0]||(e[0]=r=>a.$router.push("/items/new"))},{default:s(()=>[...e[1]||(e[1]=[u("新增作品",-1)])]),_:1})]),n(k,{data:d.value,stripe:""},{default:s(()=>[n(o,{prop:"id",label:"ID",width:"80"}),n(o,{prop:"title",label:"标题","min-width":"180"}),n(o,{prop:"fandom",label:"Fandom",width:"140"}),n(o,{prop:"cp",label:"CP",width:"140"}),n(o,{prop:"rating",label:"评分",width:"100"}),n(o,{label:"操作",width:"220"},{default:s(({row:r})=>[n(p,{text:"",onClick:g=>a.$router.push(`/items/${r.id}`)},{default:s(()=>[...e[2]||(e[2]=[u("详情",-1)])]),_:1},8,["onClick"]),n(p,{text:"",onClick:g=>a.$router.push(`/items/edit/${r.id}`)},{default:s(()=>[...e[3]||(e[3]=[u("编辑",-1)])]),_:1},8,["onClick"]),n(p,{text:"",type:"danger",onClick:g=>$(r.id)},{default:s(()=>[...e[4]||(e[4]=[u("删除",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"]),n(q,{layout:"prev, pager, next",total:m.value,"page-size":t.size,"current-page":t.page,onCurrentChange:C},null,8,["total","page-size","current-page"])])}}},K=I(S,[["__scopeId","data-v-0b9e1068"]]);export{K as default};

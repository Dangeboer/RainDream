import{_ as x,q as z,c as L,b as m,t as R,a as n,w as l,s as E,r as u,h as y,i as M,j as V,u as W,o as B,g as c,v as D,E as P}from"./index-Di_xo8Hi.js";import{d as S,a as j}from"./item-WbUbsj5p.js";import"./http-CRxuZnxf.js";const A={class:"card-panel panel"},F={class:"head"},X={__name:"ItemListView",setup(K){const r=V(),h=W(),f=y([]),b=y(0),_=y(null),a=M({page:1,size:10,contentType:void 0,mediaType:void 0}),w={1:"文章",2:"图绘",3:"精修",4:"混剪",5:"解析",6:"吐槽",7:"主创说",8:"RPS",9:"其他"},v={1:"文本",2:"图片",3:"视频",4:"链接"},C=E(()=>{const t=["全部资源"];return a.contentType&&t.push(w[a.contentType]||`内容类型 ${a.contentType}`),a.mediaType&&t.push(v[a.mediaType]||`格式 ${a.mediaType}`),t.join(" / ")}),d=t=>{const e=Number.parseInt(t,10);return Number.isNaN(e)||e<=0?void 0:e},$=()=>{a.page=d(r.query.page)||1,a.contentType=d(r.query.contentType),a.mediaType=d(r.query.mediaType)},g=async()=>{const t={page:a.page,size:a.size};a.contentType&&(t.contentType=a.contentType),a.mediaType&&(t.mediaType=a.mediaType);const e=await j(t);f.value=(e==null?void 0:e.records)||[],b.value=Number((e==null?void 0:e.total)||0)},k=async t=>{await h.push({path:"/items",query:{...r.query,page:t}})},q=async t=>{await D.confirm("确认删除该作品吗？","提示",{type:"warning"}),await S(t),P.success("删除成功"),g()},I=t=>{var i;if(!t.shiftKey)return;const e=(i=_.value)==null?void 0:i.$el;if(!e)return;const o=e.querySelector(".el-table__body-wrapper .el-scrollbar__wrap")||e.querySelector(".el-table__body-wrapper");if(!o||o.scrollWidth<=o.clientWidth)return;const s=Math.abs(t.deltaX)>0?t.deltaX:t.deltaY;o.scrollLeft+=s,t.preventDefault()};return z(()=>r.query,()=>{$(),g()},{immediate:!0}),(t,e)=>{const o=u("el-button"),s=u("el-table-column"),i=u("el-table"),N=u("el-pagination");return B(),L("section",A,[m("div",F,[m("h2",null,R(C.value),1),n(o,{type:"primary",onClick:e[0]||(e[0]=p=>t.$router.push("/items/new"))},{default:l(()=>[...e[1]||(e[1]=[c("新增作品",-1)])]),_:1})]),m("div",{class:"table-wrap",onWheelCapture:I},[n(i,{ref_key:"tableRef",ref:_,data:f.value,stripe:""},{default:l(()=>[n(s,{prop:"id",label:"ID",width:"80"}),n(s,{prop:"title",label:"标题","min-width":"180"}),n(s,{prop:"fandom",label:"Fandom",width:"140"}),n(s,{prop:"cp",label:"CP",width:"140"}),n(s,{prop:"rating",label:"评分",width:"100"}),n(s,{label:"操作",width:"220"},{default:l(({row:p})=>[n(o,{text:"",onClick:T=>t.$router.push(`/items/${p.id}`)},{default:l(()=>[...e[2]||(e[2]=[c("详情",-1)])]),_:1},8,["onClick"]),n(o,{text:"",onClick:T=>t.$router.push(`/items/edit/${p.id}`)},{default:l(()=>[...e[3]||(e[3]=[c("编辑",-1)])]),_:1},8,["onClick"]),n(o,{text:"",type:"danger",onClick:T=>q(p.id)},{default:l(()=>[...e[4]||(e[4]=[c("删除",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])],32),n(N,{layout:"prev, pager, next",total:b.value,"page-size":a.size,"current-page":a.page,onCurrentChange:k},null,8,["total","page-size","current-page"])])}}},H=x(X,[["__scopeId","data-v-89b187ae"]]);export{H as default};
